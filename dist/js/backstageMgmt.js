var g_structs=eval("("+parent.G_MIX_MUL_INTANCES+")");$(document).ready(function(){initPage()});function initPage(){parent.CurrentStructs.init();parent.HTML.hTable($,"mainContainer",g_structs);window.setTimeout(function(){parent.CurrentStructs.evaluation($);initSpecialAction();$("#mainContainer").show();bindBtnEvent();bindToolTip();initMainBoxContentHeight();parent.autoHeight()},300)}function initMainBoxContentHeight(){$("table[id^=instanceBox_]").each(function(){var a=$("tr",$(this)).length;if(a>1){$(this).parent().height(133+(a-2)*57+170)}else{$(this).parent().height(58)}})}function initAddBoxContentHeight(c){var b=$(c).attr("structID");var a=$(".box-content",$("#multiInstanceAddDiv_"+b));a.height(153+170)}function initSpecialAction(){$("div[id^=14001_14001002_]").each(function(){specialAction($(this).children())});if($("#14001Add_14001002_0").children().val()=="6"){$("#14001Add_14001011_0").show();$("#14001Add_14001012_0").show()}else{$("#14001Add_14001011_0").hide();$("#14001Add_14001012_0").hide()}}function specialAction(a){if($(a).parent().attr("id")=="14001Add_14001002_0"){if($(a).val()=="6"){$("#14001Add_14001011_0").show();$("#14001Add_14001012_0").show()}else{$("#14001Add_14001011_0").children().val("");$("#14001Add_14001012_0").children().val("");top.HTML.update($("#14001Add_14001011_0").children());top.HTML.update($("#14001Add_14001012_0").children());$("#14001Add_14001011_0").hide();$("#14001Add_14001012_0").hide()}}else{var b=$(a).parent().attr("id").split("_")[2];if($(a).val()=="6"){$("#14001_14001011_"+b).show();$("#14001_14001012_"+b).show()}else{$("#14001_14001011_"+b).children().val("");$("#14001_14001012_"+b).children().val("");top.HTML.update($("#14001_14001011_"+b).children());top.HTML.update($("#14001_14001012_"+b).children());$("#14001_14001011_"+b).hide();$("#14001_14001012_"+b).hide()}}}function bindBtnEvent(){$('[data-rel="chosen"],[rel="chosen"]').chosen();$(".btn-multisave").click(function(a){a.preventDefault();multiSave(this);parent.autoHeight()});$(".btn-multiadd").click(function(a){a.preventDefault();multiAdd(this);bindBtnEvent2();parent.autoHeight()});$(".btn-multiminus").click(function(a){a.preventDefault();multiDelete(this);parent.autoHeight()});$(".btn-multirefresh").click(function(a){a.preventDefault();multiRefresh(this);parent.autoHeight()});$(".btn-minimize").click(function(b){b.preventDefault();var a=$(this).parent().parent().next(".box-content");if(a.is(":visible")){$("i",$(this)).removeClass("chevron-up").addClass("chevron-down");$(this).removeClass("btn-minimize").addClass("btn-maximize")}else{$("i",$(this)).removeClass("chevron-down").addClass("chevron-up");$(this).removeClass("btn-maximize").addClass("btn-minimize")}bindToolTip();a.slideToggle();parent.autoHeight()})}function bindBtnEvent2(){$('[data-rel="chosen"],[rel="chosen"]').chosen();$(".btn-comfirm").click(function(a){a.preventDefault();multiAddConfirm(this);bindToolTip();parent.autoHeight()});$(".btn-cancel").click(function(a){a.preventDefault();multiAddCancel(this);parent.autoHeight()})}function bindToolTip(){$(".btn-minimize").attr("data-original-title",top.T.BTN.Minimize);$(".btn-maximize").attr("data-original-title",top.T.BTN.Maximize);$(".btn-multisave").attr("data-original-title",top.T.BTN.Save);$(".btn-multiadd").attr("data-original-title",top.T.BTN.Add);$(".btn-multiminus").attr("data-original-title",top.T.BTN.Delete);$(".btn-multirefresh").attr("data-original-title",top.T.BTN.Refresh);$(".btn-comfirm").attr("data-original-title",top.T.BTN.Confirm);$(".btn-cancel").attr("data-original-title",top.T.BTN.Cancel);$("input:checkbox, input:radio, input:file").not('[data-no-uniform="true"],#uniform-is-ajax').uniform();$('[rel="tooltip"],[data-rel="tooltip"]').tooltip({"placement":"bottom",delay:{show:400,hide:200}})}function multiSave(a){var b=$(a).attr("structID");parent.CurrentStructs.save(b)}function selectAll(c){var e=$(c).attr("structID"),d=$("."+e+"_instance_select"),a=0,b=0;if($(c).is(":checked")){for(a=0,b=d.length;a<b;a+=1){$(d[a]).attr("checked","checked");$(d[a]).parent().addClass("checked")}}else{for(a=0,b=d.length;a<b;a+=1){$(d[a]).removeAttr("checked");$(d[a]).parent().removeClass("checked")}}}function multiDelete(d){var g=$(d).attr("structID"),f=$("."+g+"_instance_select"),b=[],a=0,c=0,e=false;for(a=0,c=f.length;a<c;a+=1){if($(f[a]).is(":checked")){b.push(window.parseInt($(f[a]).attr("instanceIndex"),10))}}if(b.length!==0){e=top.CurrentStructs.instanceDel(g,b);multiRefresh(d);top.ModalCommon.open(top.T.Main.Notice,top.T.AlertInfo.DelInstanceSuccess,"ok")}else{top.ModalCommon.open(top.T.Main.Notice,top.T.AlertInfo.OperationFail,"error")}}function multiRefresh(a){window.setTimeout(function(){var b=$(a).attr("structID");top.HTML.refreshHTable($,b,1);top.CurrentStructs.evaluation($,b,1);initSpecialAction();initMainBoxContentHeight();$('[data-rel="chosen"],[rel="chosen"]').chosen();$("input:checkbox, input:radio, input:file").not('[data-no-uniform="true"],#uniform-is-ajax').uniform();top.ModalCommon.open(top.T.Main.Notice,top.T.AlertInfo.OperationSuccess,"ok")},300)}function gotoPage(a){var c=$(a).attr("structID"),b=window.parseInt($(a).val(),10);top.HTML.page($,c,b);top.CurrentStructs.evaluation($,c,b)}function multiAdd(g){var i=$(g).attr("structID"),j=parent.CurrentStructs.get(i+"Add");if("14001"==i){var d="get BackIfParam;";var e=top.LMT.cmdAsyn(d,36000);var c=top.LMT.parser(e);if(c.result==="000"){var h=/BackIfID/g;if(c.content.match(h)&&c.content.match(h).length>=3){top.ModalCommon.open(top.T.Main.Notice,"已达到支持的最大数目","error");return}}}var f=top.HTML.createAddTable(j),a=$("#multiInstanceAddDiv_"+i),b=$("#multiInstanceAddTable_"+i);b.empty().append(f);top.CurrentStructs.evaluation($,i+"Add");initSpecialAction();a.show();initAddBoxContentHeight(g);parent.autoHeight()}function multiAddConfirm(c){var e=$(c).attr("structID"),a=$("#multiInstanceAddDiv_"+e),b=$("#multiInstanceAddTable_"+e),d=false;var d=parent.CurrentStructs.instanceAdd(e);if(d){a.hide();b.empty();multiRefresh(c);top.ModalCommon.open(top.T.Main.Notice,top.T.AlertInfo.AddInstanceSuccess,"ok")}}function multiAddCancel(c){var d=$(c).attr("structID"),a=$("#multiInstanceAddDiv_"+d),b=$("#multiInstanceAddTable_"+d);parent.CurrentStructs.name_valInit(d+"Add");a.hide();b.empty()}function showAddList(a){}function showArray(a){parent.ArrayView.show(a)}function showBitMap(a){parent.BitMapView.show(a)}function updateCallback(a){specialAction(a)};