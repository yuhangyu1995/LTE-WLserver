var logTab=new TABLE(1,1,"logTab","paramList"),timer;if(top.AutoRefresh_flag===undefined){top.AutoRefresh_flag=true}$(document).ready(function(){onlineorNo();translate();bindBtnEvent();bindToolTip();logTab.data_reload_sw=0;logTab.menuPos=2;getLog();window.setTimeout(function(){clearTimeout(timer);timer=window.setTimeout(function(){if(top.AutoRefresh_flag===true){getLog()}else{return}window.setTimeout(arguments.callee,60*1000)},60*1000)},100)});function translate(){$("#Diagnosticslog").text(top.T.BTN.Diagnosis)}function bindBtnEvent(){$(".btn-stoprefresh").click(function(a){a.preventDefault();if(top.AutoMonitor_flag){return}if(top.AutoRefresh_flag){$("i",$(this)).removeClass("off").addClass("retweet");$(this).removeClass("btn-stoprefresh").addClass("btn-autorefresh")}else{$("i",$(this)).removeClass("retweet").addClass("off");$(this).removeClass("btn-autorefresh").addClass("btn-stoprefresh")}if(top.AutoRefresh_flag){top.AutoRefresh_flag=false}else{top.AutoRefresh_flag=true;clearTimeout(timer);timer=window.setTimeout(function(){if(top.AutoRefresh_flag){getLog()}else{return}window.setTimeout(arguments.callee,10*1000)},10*1000)}bindToolTip()});$(".btn-refresh").click(function(a){a.preventDefault();if(top.AutoMonitor_flag){return}getLog();top.ModalCommon.open(top.T.Main.Notice,top.T.AlertInfo.OperationSuccess,"ok")});$(".btn-minimize").click(function(b){b.preventDefault();var a=$(this).parent().parent().next(".box-content");if(a.is(":visible")){$("i",$(this)).removeClass("chevron-up").addClass("chevron-down");$(this).removeClass("btn-minimize").addClass("btn-maximize")}else{$("i",$(this)).removeClass("chevron-down").addClass("chevron-up");$(this).removeClass("btn-maximize").addClass("btn-minimize")}bindToolTip();a.slideToggle();parent.autoHeight()})}function bindToolTip(){$(".btn-autorefresh").attr("data-original-title",top.T.BTN.TurnOnAutoRefresh);$(".btn-stoprefresh").attr("data-original-title",top.T.BTN.TurnOffAutoRefresh);$(".btn-refresh").attr("data-original-title",top.T.BTN.Reload);$(".btn-minimize").attr("data-original-title",top.T.BTN.Minimize);$(".btn-maximize").attr("data-original-title",top.T.BTN.Maximize);$('[rel="tooltip"],[data-rel="tooltip"]').tooltip({"placement":"bottom",delay:{show:400,hide:200}})}function getLog(){parent.Modal.progress("Loading data,please wait...");var a="web getFile:path=/OAM/software/web/web_page/DiagnosticsInfo.csv;";parent.LMT.cmdSyn(a,function(c){if(parent.LMT.isCmdSuccess(c)){parent.Modal.delProgress();var b=[];b=dataParse(c);showLog(b);parent.autoHeight()}else{parent.Modal.open(top.T.AlertInfo.OperationFail,"获取不到日志","error")}})}function showLog(d){logTab.EMPTY();var a=new Array("No.","Time","Mode","Num.","CurAlarm","HisAlarm","IPwr","OPwr","RPwr","Tem","Syn","UnSynCnt");logTab.cols=a.length;if(d.length===0){logTab.PUSH_MULTI_DATA(d)}else{for(var c=0;c<d.length;c++){logTab.PUSH_MULTI_DATA(d[c])}}logTab.rowID=0;logTab.title_space=["2%","12%","8%","6%","8%","8%","5%","5%","5%","5%","3%","7%"];logTab.getExternMenu=buttonMenu;logTab.view_width=1024;logTab.SET_TITLE(a.toString());var b=logTab.SHOW_TABLE();$("#container").append(b);logTab.JUMP("last")}function buttonMenu(){var a="<input type='button' value="+top.T.BTN.Refresh+" onclick='getLog()'/>";return a}function Auto_refresh(){if(top.AutoMonitor_flag){return}if(top.AutoRefresh_flag){$("#Auto_refresh").text(top.T.BTN.TurnOnAutoRefresh);top.AutoRefresh_flag=false}else{$("#Auto_refresh").text(top.T.BTN.TurnOffAutoRefresh);top.AutoRefresh_flag=true;clearTimeout(timer);timer=window.setTimeout(function(){if(top.AutoRefresh_flag===true){getLog()}else{return}window.setTimeout(arguments.callee,60*1000)},60*1000)}}function dataParse(o){var a=parent.LMT.parser(o),c=a.content,g="",h=[],k=[],r=[],j=[],l=[],b=[],d=[],f=[],m=[],n=[],q=[],p=[],t=[],g=c.substring(c.indexOf("date")+8,c.length);if(g.length>0){g=g.split("\n");for(var e=0;e<g.length;e+=1){var s=g[e].split("\t");if(s&&s.length==16){k[e]=e+1;r[e]=s[1].substring(0,4)+"-"+s[1].substring(4,6)+"-"+s[1].substring(6,8)+"-"+s[1].substring(8,10)+":"+s[1].substring(10,12)+":"+s[1].substring(12);j[e]=s[2];l[e]=s[3];b[e]=s[4];d[e]=s[5];f[e]=s[6];m[e]=s[7];n[e]=s[8];q[e]=s[9];p[e]=s[10];t[e]=s[11];h[e]=[k[e],r[e],j[e],l[e],b[e],d[e],f[e],m[e],n[e],q[e],p[e],t[e]]}}return h}else{k=[""];r=[""];j=[""];l=[""];b=[""];d=[""];f=[""];m=[""];n=[""];q=[""];p=[""];t=[""];h[0]=[k[0],r[0],j[0],l[0],b[0],d[0],f[0],m[0],n[0],q[0],p[0],t[0]];return h}};