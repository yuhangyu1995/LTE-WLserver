var HTML=(function(){var n=" onmouseover='tr_over(this)' onmouseout='tr_out(this)' ",k=" onmouseout='top.HTML.update(this)' onkeyup='top.HTML.update(this)' ";(function(){if(top.isMobile()){n=" onmouseover='tr_over_mobile(this)' onmouseout='tr_out_mobile(this)' ";k=" onblur='top.HTML.update(this)' "}}());function i(r,v,x){r("#"+v).empty();var t=0,u=x.length,w="",s="";for(t=0;t<u;t+=1){w=x[t];s=c(w);r("#"+v).append(s)}}function c(x){var v=parent.localDB.T_search("c_param","StructID",x),u="",t=[],r=Struct.isMulInstanceAddable(v),z=v[0][top.c_paramRowIndex.StructName],s={},w={},y=top.c_paramRowIndex.StructID;if(top.Language==="EN"){u=v[0][top.c_paramRowIndex.StructName]}else{u=v[0][top.c_paramRowIndex.StructCnName];if(u===""){u=v[0][top.c_paramRowIndex.StructName]}}s=top.Struct.getStructByName(z);CurrentStructs.push(s);if(r){w=top.objectClone(s);Struct.setNewStructID(w.structDesc,x+"Add");CurrentStructs.push(w);CurrentStructs.name_valInit(w.structDesc[0][y])}t.push('<div class="row-fluid sortable">');t.push('<div class="box span12">');t.push('<div class="box-header" data-original-title>');t.push('<h2><i class="halflings-icon align-justify"></i><span class="break"></span>',u,"</h2>");t.push('<div class="box-icon">');t.push('<a href="#" class="btn-multisave" structID="',x,'" data-rel="tooltip" data-original-title=""><i class="halflings-icon ok"></i></a>');t.push('<a href="#" class="btn-multiadd" structID="',x,'" data-rel="tooltip" data-original-title=""><i class="halflings-icon plus"></i></a>');t.push('<a href="#" class="btn-multiminus" structID="',x,'" data-rel="tooltip" data-original-title=""><i class="halflings-icon minus"></i></a>');t.push('<a href="#" class="btn-multirefresh" structID="',x,'" data-rel="tooltip" data-original-title=""><i class="halflings-icon refresh"></i></a>');t.push('<a href="#" class="btn-minimize" structID="',x,'" data-rel="tooltip" data-original-title=""><i class="halflings-icon chevron-up"></i></a>');t.push("</div>");t.push("</div>");t.push('<div class="box-content" style="overflow:auto;">');t.push('<table class="table table-bordered" id="instanceBox_',x,'">');t.push(b(v,r));t.push("</table>");t.push("</div>");t.push("</div>");t.push("</div>");if(r){t.push('<div class="row-fluid sortable" style="display:none;" id="multiInstanceAddDiv_',x,'">');t.push('<div class="box span12">');t.push('<div class="box-header" data-original-title>');t.push('<h2><i class="halflings-icon align-justify"></i><span class="break"></span>',top.T.BTN.Add,"</h2>");t.push('<div class="box-icon">');t.push('<a href="#" class="btn-comfirm" structID="',x,'" data-rel="tooltip" data-original-title=""><i class="halflings-icon ok"></i></a>');t.push('<a href="#" class="btn-cancel" structID="',x,'" data-rel="tooltip" data-original-title=""><i class="halflings-icon remove"></i></a>');t.push("</div>");t.push("</div>");t.push('<div class="box-content" style="overflow:auto;">');t.push('<table class="table table-bordered" id="multiInstanceAddTable_',x,'">');t.push("</table>");t.push("</div>");t.push("</div>");t.push("</div>")}return t.join("")}function a(x){var w=x.structDesc,t=[],r=0,y=-1,s={},v="";MemberCnNameIndex=top.c_paramRowIndex.MemberCnName,MemberNameIndex=top.c_paramRowIndex.MemberName,WebTypeIndex=top.c_paramRowIndex.WebType,LevelIndex=top.c_paramRowIndex.Level;t.push("<tbody>","<tr>");for(var u=0;u<w.length;u++){if(top.Language==="EN"){v=w[u][MemberNameIndex]}else{v=$.trim(w[u][MemberCnNameIndex])===""?w[u][MemberNameIndex]:w[u][MemberCnNameIndex]}t.push("<th nowrap='nowrap'><font size='2px'>",v,"</font></th>")}t.push("</tr>","<tr>");for(r=0,cLen=w.length;r<cLen;r+=1){y=$.trim(w[r][WebTypeIndex])===""?0:window.parseInt(w[r][WebTypeIndex],10);s=g(0,r,w[r]);t.push("<td>"+h(y,s,false,"Add")+"</td>")}t.push("</tr>","</tbody>");return t.join("")}function d(t,r){var s=['<div class="tabBar"  id="tabBar',t,'">'];s.push('<a class="btn btn-success" href="#tabBar',t,'" onclick="multiSave(this);" structID="',t,'"><span>',top.T.BTN.Save,"</span></a>","&nbsp;");if(r){s.push('<a class="btn btn-success" href="#tabBar',t,'" onclick="multiAdd(this);" structID="',t,'"><span>',top.T.BTN.Add,"</span></a>","&nbsp;",'<a class="btn btn-success" href="#tabBar',t,'" onclick="multiDelect(this);" structID="',t,'"><span>',top.T.BTN.Delete,"</span></a>","&nbsp;")}s.push('<a class="btn btn-success" href="#tabBar',t,'" onclick="multiRefresh(this);" structID="',t,'"><span>',top.T.BTN.Refresh,"</span></a>","&nbsp;");s.push('<span id="pageSelectorSpan_'+t+'">');s.push(e(t));s.push("</span></div>");return s.join("")}function e(w){var r=CurrentStructs.get(w),s=[""],v=(r.name_val.length/r.structDesc.length),u=0,t=0;if(v>G.PageRows){u=v/G.PageRows;if((v%G.PageRows)>0){u+=1}s.push("&nbsp;&nbsp;&nbsp;",top.T.ParamView.PageN,'&nbsp;<select id="pageSelector_',w,'" structID="',w,'" onchange="gotoPage(this)">');for(t=1;t<=u;t+=1){s.push('<option value="'+t+'">'+t+"</option>")}s.push("</select>&nbsp;",top.T.ParamView.PageN2)}return s.join("")}function g(v,r,s){var z=$.trim(s[top.c_paramRowIndex.WebType])===""?0:window.parseInt(s[top.c_paramRowIndex.WebType],10),y=Transfer.parseDbColumn(s[top.c_paramRowIndex.Level]),t={},u=[],w="",x=false;t.cols=r;t.row=v;t.structDesc=s;t.id=s[top.c_paramRowIndex.StructID]+"_"+s[top.c_paramRowIndex.MemberID]+"_"+v.toString();t.structName=s[top.c_paramRowIndex.StructName];t.memberType=z;t.name=s[top.c_paramRowIndex.MemberName];t.structID=s[top.c_paramRowIndex.StructID];t.memberID=s[top.c_paramRowIndex.MemberID];t.proto="";t.typeclass="";t.parentType="";u=y.split("|");w="";if(top.Language==="EN"){if(u.length>=7&&u[6].length>=1){w="title='"+u[6]+"'"}}else{if(u.length>=2&&u[1].length>=1){w="title='"+u[1]+"'"}}t.tips=w;if(u.length>=1&&u[0].length>=1){t.Unit="&nbsp;&nbsp;"+u[0]}else{t.Unit=""}if(u.length>=6&&u[5].length>=1){x=(window.parseInt(u[5],10)===1)}else{x=false}t.unique=x;return t}function b(F,r,C){var H="",v={},w=[],E=0,D=0,B="even",t=0,s=0,L=-1,K="",u={},x=[],J="",M=top.c_paramRowIndex.WebType,y=top.c_paramRowIndex.Level,A=top.c_paramRowIndex.MemberName,z=top.c_paramRowIndex.MemberID,I=top.c_paramRowIndex.StructID;H=F[0][I];v=CurrentStructs.get(H);if(typeof(C)==="undefined"){C=1}D=(C-1)*G.PageRows;E=v.name_val.length/v.sLength;if(E>(D+G.PageRows)){E=D+G.PageRows}for(E;D<E;D+=1){B=(D%2)===1?"odd":"even";w.push("<tr intance='",D,"'>");if(r){w.push('<td><input type="checkbox" class="',H,'_instance_select" instanceIndex="',D,'"></td>')}for(t=0,s=F.length;t<s;t+=1){L=$.trim(F[t][M])===""?0:window.parseInt(F[t][M],10);K=Transfer.parseDbColumn(F[t][y]);if(!top.USER.isAuthorised(top.USER.getStructLevel(K,"p"))||L===-1){continue}u={};u=g(D,t,F[t]);w.push("<td>"+h(L,u,false)+"</td>")}w.push("</tr>")}if(w.length===0){return["<tr><td colspan='",v.sLength,"'>no instance</td></tr>"].join("")}else{return j(F,r)+w.join("")}}function j(y,r){var C=["<tr>"],B=0,t=0,s=[],D,z="",E="",F=top.c_paramRowIndex.WebType,u=top.c_paramRowIndex.Level,v=top.c_paramRowIndex.MemberCnName,w=top.c_paramRowIndex.MemberName,A=top.c_paramRowIndex.StructID,x="";z=y[0][A];if(r){C.push("<th nowrap='nowrap'><input type='checkbox' structID='",z,"' onclick='selectAll(this);'/></th>")}for(B=0,t=y.length;B<t;B+=1){if(window.parseInt(y[B][F],10)===-1){continue}E=Transfer.parseDbColumn(y[B][u]);if(!top.USER.isAuthorised(top.USER.getStructLevel(E,"p"))){continue}s=E.split("|");D="";if(s.length>=1&&s[0].length>=1){D="("+s[0]+")"}if(top.Language==="EN"){x=y[B][w]}else{x=$.trim(y[B][v])===""?y[B][w]:y[B][v]}C.push("<th nowrap='nowrap'><font size='2px'>",x,D,"</font></th>")}C.push("</tr>");return C.join("")}function m(r,u,s){top.CurrentStructs.refresh(u);var t=e(u);r("#pageSelectorSpan_"+u).empty().append(t);l(r,u,s)}function l(r,w,u){var v=CurrentStructs.get(w).structDesc,t="",s=Struct.isMulInstanceAddable(v);t=b(v,s,u);r("#instanceBox_"+w).empty().append(t)}function p(M,H,F){var J=M.structDesc,t={},r=false,u=[],D="odd",v=0,I=0,P=0,w="",N="",C="",E="",s="",Q="",O=0,y=top.c_paramRowIndex.Level,R=top.c_paramRowIndex.WebType,B=top.c_paramRowIndex.MemberName,A=top.c_paramRowIndex.MemberID,z=top.c_paramRowIndex.MemberCnName,K=top.c_paramRowIndex.StructID,L=top.c_paramRowIndex.StructName,x=top.c_paramRowIndex.IsPrimaryKey;if(H){r=H}if(top.Language==="EN"){s=" :&nbsp;&nbsp;&nbsp;"}else{s="："}for(v=0,I=J.length;v<I;v+=1){Q=Transfer.parseDbColumn(J[v][y]);if(!top.USER.isAuthorised(top.USER.getStructLevel(Q,"p"))&&!r){continue}D=(v%2)===1?"odd":"even";P=$.trim(J[v][R])===""?0:window.parseInt(J[v][R],10);t={};t=g(0,v,J[v]);if(top.Language==="EN"){if(M.memberNames){C=M.memberNames[v]}else{C=J[v][B]}}else{if($.trim(J[v][z])===""){if(M.memberNames){C=M.memberNames[v]}else{C=J[v][B]}}else{C=J[v][z]}}if(window.parseInt(J[v][x],10)===1||t.unique){E="&nbsp;<label style='color:red;'>*</label>"}else{E=""}if(F){if(P==0){P=10}else{if(P==1){P=11}}}if(P>=0){u.push("<div class='control-group success'>","<label class='control-label' for='",t.memberID,"' style='width:30% !important;margin-left:5%;'>",C,"</label>",h(P,t,true),"</div>")}}return u.join("")}function q(){return["<tr><th width='40%' class='firstCell' >","</th><th  width='60%' class='lastCell' >","</th></tr>"].join("")}function h(v,r,s,u){var t="style='margin-left:40%;'";return["<div id='",r.id,"' structName='",r.structName,"' memberType='",v,"' class='controls'",s?t:"",">",f(v,r,u),"</div>"].join("")}function f(E,r,x){var B=window.parseInt(E,10),t=[],s=0,u=0,D=top.c_paramRowIndex.TypeDesc,C=Transfer.parseDbColumn(r.structDesc[D]),y=[],z=[],w=[],A=[],v=";background:#ffffff;opacity:0.4;filter:alpha(opacity=50);";switch(B){case -1:break;case 0:t.push("<input id='",r.memberID,"' intanceIndex='",r.row,"' parentType='",r.parentType,"' name='",r.name,"' type='text' structID='",r.structID,"' memberID='",r.memberID,"' structName='",r.structName,"' memberType='",E,"' proto='",r.proto,"' ",r.tips," style='border-color: #ccc !important;' onkeyup='top.HTML.update(this)' onmouseout='top.HTML.update(this)' />");break;case 1:A=top.Transfer.wtListParser(C);y=A.selectNames;z=A.selectVals;t.push("<select data-rel='chosen' id='",r.memberID,x?x:"","_",r.row,"' intanceIndex='",r.row,"' parentType='",r.parentType,"' name='",r.name,"' structID='",r.structID,"' memberID='",r.memberID,"' structName='",r.structName,"' memberType='",E,"' proto='",r.proto,"' onchange='top.HTML.update(this,updateCallback)'>");for(s=0,u=y.length;s<u;s+=1){t.push("<option value='",z[s],"' title='",y[s],"'>",y[s],"</option>")}t.push("</select>");break;case 2:t.push("<input class='textInput ",r.typeclass,"' intanceIndex='",r.row,"' parentType='",r.parentType,"' name='",r.name,"' style='vertical-align:middle; cursor:pointer;' onclick='showArray(this)' "," type='text' readonly='readonly' value='' structID='",r.structID,"' memberID='",r.memberID,"' structName='",r.structName,"' memberType='",E,"' proto='",r.proto,"' onkeyup='top.HTML.update(this)'/>");break;case 3:t.push("<input class='textInput ",r.typeclass,"' intanceIndex='",r.row,"' parentType='",r.parentType,"' name='",r.name,"' style='vertical-align:middle;' type='password' value='' structID='",r.structID,"' memberID='",r.memberID,"' ",r.tips," structName='",r.structName,"' memberType='",E,"' proto='",r.proto,"'",k,"/>");break;case 4:y=C.split(",");for(s=0,u=y.length;s<u;s+=1){t.push("<input class='textInput ",r.typeclass,"' intanceIndex='",r.row,"' parentType='",r.parentType,"' name='",r.name,"' style='vertical-align:middle; width:30px; border:none;background:transparent;' "," type='checkbox' value='0' alt='one' structID='",r.structID,"' memberID='",r.memberID,"' structName='",r.structName,"' memberType='",E,"' proto='",r.proto,"' onclick='top.HTML.update(this)' />","&nbsp;&nbsp;");if((s+1)%3===0&&s!==(y.length-1)){t.push("<br />")}}break;case 5:t.push("<input class='",r.typeclass,"' intanceIndex='",r.row,"' parentType='",r.parentType,"' name='",r.name,"' style='vertical-align:middle;' type='button' value='查设' structID='",r.structID,"' memberID='",r.memberID,"' structName='",r.structName,"' memberType='",E,"' proto='",r.proto,"' onkeyup='top.HTML.update(this)' onclick='showAddList(this)' />");break;case 6:t.push("<input class='textInput ",r.typeclass,"' intanceIndex='",r.row,"' parentType='",r.parentType,"' name='",r.name,"' style='vertical-align:middle; width:30px; border:none;background:transparent;' "," type='checkbox' value='0' alt='one' structID='",r.structID,"' memberID='",r.memberID,"' id='",r.memberID,"' structName='",r.structName,"' memberType='",E,"' proto='",r.proto,"' onclick='top.HTML.update(this,updateCallback)' />","<label for='",r.memberID,"'>",C,"</label>");break;case 7:t.push("<a class='",r.typeclass,"' intanceIndex='",r.row,"' parentType='",r.parentType,"' name='",r.name,"' style='vertical-align:middle;' structID='",r.structID,"' memberID='",r.memberID,"' structName='",r.structName,"' memberType='",E,"' proto='' href ='#' onclick='top.HTML.update(this)'>",C,"</a>");break;case 8:t.push("<p class='textP ",r.typeclass,"' intanceIndex='",r.row,"' parentType='",r.parentType,"' name='",r.name,"' style='vertical-align:middle;' structID='",r.structID,"' memberID='",r.memberID,"' structName='",r.structName,"' memberType='",E,"' proto='",C,"'></p>");break;case 9:t.push("<input class='textInput ",r.typeclass,"' intanceIndex='",r.row,"' parentType='",r.parentType,"' name='",r.name,"' style='vertical-align:middle; cursor:pointer;' onclick='showBitMap(this)' "," type='text' readonly='readonly' value='' structID='",r.structID,"' memberID='",r.memberID,"' structName='",r.structName,"' memberType='",E,"' proto='",r.proto,"' onkeyup='top.HTML.update(this)'/>");break;case 10:t.push("<span class='uneditable-input' intanceIndex='",r.row,"' parentType='",r.parentType,"' name='",r.name,"' structID='",r.structID,"' memberID='",r.memberID,"' structName='",r.structName,"' memberType='",E,"' proto='",r.proto,"'/>");break;case 11:A=top.Transfer.wtListParser(C);y=A.selectNames;z=A.selectVals;t.push("<select id='",r.memberID,"' intanceIndex='",r.row,"' parentType='",r.parentType,"' name='",r.name,"' structID='",r.structID,"' memberID='",r.memberID,"' structName='",r.structName,"' memberType='",E,"' proto='",r.proto,"' disabled='disabled' style='display:none'>");for(s=0,u=y.length;s<u;s+=1){t.push("<option value='",z[s],"' title='",y[s],"'>",y[s],"</option>")}t.push("</select><span class='uneditable-input'></span>");break;case 12:t.push("<input class='textInput ",r.typeclass,"' intanceIndex='",r.row,"' parentType='",r.parentType,"' name='",r.name,"' ","' style='vertical-align:middle; cursor:pointer;",v," type='text' readonly='readonly' value='' structID='",r.structID,"' memberID='",r.memberID,"' structName='",r.structName,"' memberType='",E,"' proto='",r.proto,"' readonly='readonly'/>");break;case 13:t.push("<input class='textInput ",r.typeclass,"' intanceIndex='",r.row,"' parentType='",r.parentType,"' name='",r.name,"' style='vertical-align:middle;",v,"' type='password' value='' structID='",r.structID,"' memberID='",r.memberID,"' ",r.tips," structName='",r.structName,"' memberType='",E,"' proto='",r.proto,"' readonly='readonly'/>");break;case 14:y=C.split(",");for(s=0,u=y.length;s<u;s+=1){t.push("<input class='textInput ",r.typeclass,"' intanceIndex='",r.row,"' parentType='",r.parentType,"' name='",r.name,"' style='vertical-align:middle; width:30px; border:none;background:transparent;' "," type='checkbox' value='0' alt='one' structID='",r.structID,"' memberID='",r.memberID,"' structName='",r.structName,"' memberType='",E,"' proto='",r.proto,"' disabled='disabled'/>","&nbsp;&nbsp;");if((s+1)%3===0&&s!==(y.length-1)){t.push("<br />")}}break;case 15:t.push("<div class='",r.typeclass,"' intanceIndex='",r.row,"' parentType='",r.parentType,"'  name='",r.name,"' style='vertical-align:middle;' "," structID='",r.structID,"' memberID='",r.memberID,"' structName='",r.structName,"' memberType='",E,"' proto='",r.proto,"' ></div>");break;case 16:t.push("<input class='textInput ",r.typeclass,"' intanceIndex='",r.row,"' parentType='",r.parentType,"' name='",r.name,"' type='checkbox' value='0' alt='one'"," style='vertical-align:middle; width:30px; border:none;background:transparent;' structID='",r.structID,"' memberID='",r.memberID,"' id='",r.memberID,"' structName='",r.structName,"' memberType='",E,"' proto='",r.proto,"' disabled='disabled' /><label for='",r.memberID,"'>",C,"</label>");break;case 20:A=top.Transfer.wtListParser(C);y=A.selectNames;z=A.selectVals;t.push("<select class='textInputSelect ",r.typeclass,"' intanceIndex='",r.row,"' parentType='",r.parentType,"' name='",r.name,"' style='height:20px;vertical-align:middle;' structID='",r.structID,"' memberID='",r.memberID,"' structName='",r.structName,"' memberType='",E,"' proto='",r.proto,"' onchange='top.HTML.update(this,updateCallback)'>");for(s=0,u=y.length;s<u;s+=1){t.push("<option value='",z[s],"' title='",y[s],"'>",y[s],"</option>")}t.push("</select>");break}return t.join("")}function o(y,r){var C="";if($(y).attr("membertype")=="10"){C=$(y).text()}else{C=$(y).val()}var A=$(y).attr("structid"),x=$(y).attr("name"),u=$(y).attr("intanceindex"),D=window.parseInt($(y).attr("memberType")),s=0,w=0;$(y).removeClass("textInputActive");if(typeof(r)!=="function"){r=function(){}}switch(D){case 0:break;case 1:break;case 2:C=$(y).attr("proto");break;case 3:break;case 4:var z="",t=$(y).parent().children(),v=0,B=t.length;for(v=0;v<B;v+=1){if($(t[v]).is("input")){continue}if($(t[v]).is(":checked")){z=z+"1"}else{z=z+"0"}}C=window.parseInt(z,2).toString();break;case 5:C=$(y).attr("proto");break;case 6:C="0";if($(y).is(":checked")){C="1"}break;case 9:C=$(y).attr("proto");break;case 20:break;default:break}CurrentStructs.update(y,A,x,C,u);r(y)}return{hTable:i,refreshHTable:m,page:l,vTable:p,vTableTitle:q,update:o,createWebTypeDesc:g,getDiv:h,createAddTable:a}}());