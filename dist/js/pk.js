var downloadCmd="",clearCmd="",filePath="",fileName="";$(document).ready(function(){translate();bindBtnEvent();bindToolTip();parent.autoHeight()});function translate(){var a='<font style="color: red;font-weight: bold;">(注意：本地数据文件断电后自动清除)</font>';$("#pkFile").html("本地数据下载 "+a);$("#pkFileDownload").text("下载");$("#pkFileClear").text("清除")}function initCmd(){var b="get SysFlashImsiMgmt;";var c=top.LMT.cmdAsyn(b);var a=top.LMT.parser(c);if(a.result==="000"){for(var d=0;d<a.name_val.length;d++){if("Enable"==a.name_val[d].name){if(a.name_val[d].val=="0"){downloadCmd="zipRamPKImsiFile;";clearCmd="clearRamPKImsiFile;";filePath="/OAM/pkImsiInfo";fileName="localImsiFile.zip"}else{if(a.name_val[d].val=="1"){downloadCmd="zipFlashPKImsiFile;";clearCmd="clearFlashPKImsiFile;";filePath="/mnt/user1/common/pkImsiInfo";fileName="localImsiFile.zip"}}}}return true}return false}function bindBtnEvent(){$(".btn-minimize").click(function(b){b.preventDefault();var a=$(this).parent().parent().next(".box-content");if(a.is(":visible")){$("i",$(this)).removeClass("chevron-up").addClass("chevron-down");$(this).removeClass("btn-minimize").addClass("btn-maximize")}else{$("i",$(this)).removeClass("chevron-down").addClass("chevron-up");$(this).removeClass("btn-maximize").addClass("btn-minimize")}bindToolTip();a.slideToggle();parent.autoHeight()})}function bindToolTip(){$(".btn-submit").attr("data-original-title",top.T.BTN.Submit);$(".btn-minimize").attr("data-original-title",top.T.BTN.Minimize);$(".btn-maximize").attr("data-original-title",top.T.BTN.Maximize);$('[rel="tooltip"],[data-rel="tooltip"]').tooltip({"placement":"bottom",delay:{show:400,hide:200}})}function pkFileDownload(){if(initCmd()){$("#apdownfile").val(fileName);$("#path").val(filePath);parent.LMT.cmdSyn(downloadCmd,function(a){if(parent.LMT.isCmdSuccess(a)){tarClean(1);document.DownLoadForm.submit()}else{parent.ModalCommon.open(top.T.Main.Notice,top.T.AlertInfo.OperationFail+"，本地数据文件不存在","error")}})}else{parent.ModalCommon.open(top.T.Main.Notice,top.T.AlertInfo.OperationFail,"error")}}function tarClean(b){$.ajaxSetup({async:false});var c="/req/rootCheckReq.asp";var a=1;if(b==null){$.post(c,null,function(d){if(d==1){a=0}})}if(a==1){c="/req/clearCacheReq.asp";$.post(c,null,function(d){if(b==null){top.ModalCommon.open(top.T.Main.Notice,top.T.AlertInfo.OperationSuccess,"ok")}})}$.ajaxSetup({async:true})}function pkFileClear(){if(initCmd()){parent.LMT.cmdSyn(clearCmd,function(a){if(parent.LMT.isCmdSuccess(a)){top.ModalCommon.open(top.T.Main.Notice,top.T.AlertInfo.OperationSuccess,"ok")}else{top.ModalCommon.open(top.T.Main.Notice,top.T.AlertInfo.OperationFail,"error")}})}else{top.ModalCommon.open(top.T.Main.Notice,top.T.AlertInfo.OperationFail,"error")}};