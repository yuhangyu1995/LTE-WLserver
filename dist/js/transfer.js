var soureBrowser=true;var upLoadPath="";$(document).ready(function(){if(top.ValidatePwd){$("#password_field").hide();showFileOptField()}else{$("#password_field").show()}translate();bindBtnEvent1();bindToolTip()});function showFileOptField(){var a=[];a.push("");a.push('<div class="row-fluid sortable">');a.push('	<div class="box span6" id="file_upload_field">');a.push('		<div class="box-header">');a.push('			<h2><i class="halflings-icon align-justify"></i><span class="break"></span><span id="AUTOUpload"></span></h2>');a.push('			<div class="box-icon">');a.push('				<a href="#" class="btn-browser1" data-rel="tooltip" data-original-title=""><i class="halflings-icon search"></i></a>');a.push('				<a href="#" class="btn-upload" data-rel="tooltip" data-original-title=""><i class="halflings-icon upload"></i></a>');a.push('				<a href="#" class="btn-minimize" data-rel="tooltip" data-original-title=""><i class="halflings-icon chevron-up"></i></a>');a.push("			</div>");a.push("		</div>");a.push('		<div class="box-content">');a.push('			<form class="form-horizontal" method="post" name="UpLoadConfigForm_auto" id="UpLoadConfigForm_auto" action="/goform/uploadConfigFile" enctype="multipart/form-data" onSubmit="">');a.push("				<fieldset>");a.push('					<div class="control-group">');a.push('						<label id="UploadFileSelect" class="control-label" style="width:30%;margin-left:5%;"></label>');a.push('						<div class="controls">');a.push('							<div class="uploader" style="margin-left: 2%;">');a.push('								<input type="file" id="fileBrowse" name="edtUpLoadFilePath_auto" onchange="document.getElementById(&quot;textfield&quot;).value=this.value">');a.push('								<span class="filename" style="-webkit-user-select: none;">No file selected</span><span class="action" style="-webkit-user-select: none;">Choose File</span>');a.push("							</div>");a.push("						</div>");a.push("					</div>");a.push('					<div class="control-group">');a.push('						<label id="To" class="control-label" style="width:30%;margin-left:5%;"></label>');a.push('						<div class="controls" style="margin-left: 37%;">');a.push('							<span class="uneditable-input" id="apdownfile_hide" name="edtDownLoadCfgFileName_hide" type="text" title=""></span>');a.push("						</div>");a.push("					</div>");a.push('					<input type="hidden" name="textfield" id="textfield"/>');a.push('					<input id="Hidden1" name="type" type="hidden" value="1" />');a.push("				</fieldset>");a.push("			</form>");a.push("		</div>");a.push("	</div>");a.push('	<div class="box span6" id="file_download_field">');a.push('		<div class="box-header">');a.push('			<h2><i class="halflings-icon align-justify"></i><span class="break"></span><span id="FileDownload"></span></h2>');a.push('			<div class="box-icon">');a.push('				<a href="#" class="btn-browser2" data-rel="tooltip" data-original-title=""><i class="halflings-icon search"></i></a>');a.push('				<a href="#" class="btn-download" data-rel="tooltip" data-original-title=""><i class="halflings-icon download"></i></a>');a.push('				<a href="#" class="btn-minimize" data-rel="tooltip" data-original-title=""><i class="halflings-icon chevron-up"></i></a>');a.push("			</div>");a.push("		</div>");a.push('		<div class="box-content" style="height: 104px;">');a.push('			<form class="form-horizontal" method="post" name="DownLoadForm" id="DownLoadForm" action="/goform/downloadConfigFile">');a.push("				<fieldset>");a.push('					<div class="control-group">');a.push('						<label id="DownloadFileSelect" class="control-label" style="width:30%;margin-left:5%;"></label>');a.push('						<div class="controls" style="margin-left: 37%;">');a.push('							<span class="uneditable-input" id="apdownfile_hide_2" name="edtDownLoadCfgFileName_hide_2" type="text"></span>');a.push("						</div>");a.push("					</div>");a.push('					<input id="apdownfile" name="edtDownLoadCfgFileName" type="hidden" value="" />');a.push('					<input id="path" name="path" type="hidden" value="/"/>');a.push("				</fieldset>");a.push("			</form>");a.push("		</div>");a.push("	</div>");a.push("</div>");a.push('<div class="row-fluid sortable">');a.push('	<div id="position_first" class="box span6" style="display: none">');a.push('		<div class="box-header">');a.push('			<h2><i class="halflings-icon align-justify"></i><span class="break"></span><span id="SelectDir"></span></h2>');a.push('			<div class="box-icon">');a.push('				<a href="#" class="btn-lastdir" data-rel="tooltip" data-original-title=""><i class="halflings-icon share-alt"></i></a>');a.push('				<a href="#" class="btn-selectdir" data-rel="tooltip" data-original-title=""><i class="halflings-icon ok"></i></a>');a.push('				<a href="#" class="btn-cancel" data-rel="tooltip" data-original-title=""><i class="halflings-icon remove"></i></a>');a.push("			</div>");a.push("		</div>");a.push('		<div class="box-content" style="overflow-y: hidden;overflow-x: auto;"></div>');a.push("	</div>");a.push('	<div id="position_last" class="box span6" style="display: none;float: right">');a.push('		<div class="box-header">');a.push('			<h2><i class="halflings-icon align-justify"></i><span class="break"></span><span id="SelectFile"></span></h2>');a.push('			<div class="box-icon">');a.push('				<a href="#" class="btn-lastdir" data-rel="tooltip" data-original-title=""><i class="halflings-icon share-alt"></i></a>');a.push('				<a href="#" class="btn-cancel" data-rel="tooltip" data-original-title=""><i class="halflings-icon remove"></i></a>');a.push("			</div>");a.push("		</div>");a.push('		<div class="box-content" style="overflow: auto"></div>');a.push("	</div>");a.push("</div>");a.push('<div id="position_share" class="row-fluid sortable" style="display: none">');a.push('	<div class="box span6">');a.push('		<div class="box-header">');a.push('			<h2><i class="halflings-icon align-justify"></i><span class="break"></span></h2>');a.push('			<div class="box-icon"></div>');a.push("		</div>");a.push('		<div class="box-content" style="overflow-y: hidden;overflow-x: auto;">');a.push('			<table id="folderList" class="table table-striped"></table>');a.push('			<input id="curpath" name="curpath" type="hidden" value=""/>');a.push("		</div>");a.push("	</div>");a.push("</div>");$("#file_opt_field").empty().append(a.join(""));getURL();translate();bindToolTip();bindBtnEvent2()}function translate(){$("#PasswordValidation").text(top.T.FileManagementPage.PasswordValidation);$("#InputPassword").text(top.T.FileManagementPage.InputPassword);$("#AUTOUpload").text(top.T.FileManagementPage.AUTOUpload);$("#UploadFileSelect").text(top.T.FileManagementPage.UploadFileSelect);$("#To").text(top.T.FileManagementPage.To);$("#FileDownload").text(top.T.FileManagementPage.FileDownload);$("#DownloadFileSelect").text(top.T.FileManagementPage.DownloadFileSelect);$("#SelectDir").text(top.T.FileManagementPage.SelectDir);$("#SelectFile").text(top.T.FileManagementPage.SelectFile)}function getURL(){var a="../../startup.txt";$.ajax({type:"GET",url:a,cache:false,success:function(b){$("#apdownfile_hide").text($.trim(b)+"/")}})}function bindBtnEvent1(){$(".btn-submit").click(function(a){a.preventDefault();validatePwd();parent.autoHeight()});$(".btn-minimize").click(function(b){b.preventDefault();var a=$(this).parent().parent().next(".box-content");if(a.is(":visible")){$("i",$(this)).removeClass("chevron-up").addClass("chevron-down");$(this).removeClass("btn-minimize").addClass("btn-maximize")}else{$("i",$(this)).removeClass("chevron-down").addClass("chevron-up");$(this).removeClass("btn-maximize").addClass("btn-minimize")}a.slideToggle();bindToolTip();parent.autoHeight()})}function bindBtnEvent2(){$(".btn-browser1").click(function(a){a.preventDefault();appendDirHtml();parent.autoHeight()});$(".btn-upload").click(function(a){a.preventDefault();submit_upload();parent.autoHeight()});$(".btn-browser2").click(function(a){a.preventDefault();browser();parent.autoHeight()});$(".btn-download").click(function(a){a.preventDefault();submit_download_apply();parent.autoHeight()});$(".btn-lastdir").click(function(a){a.preventDefault();goback();parent.autoHeight()});$(".btn-selectdir").click(function(a){a.preventDefault();makeSureApply();parent.autoHeight()});$(".btn-cancel").click(function(a){a.preventDefault();cancel();parent.autoHeight()});$(".btn-minimize").click(function(b){b.preventDefault();var a=$(this).parent().parent().next(".box-content");if(a.is(":visible")){$("i",$(this)).removeClass("chevron-up").addClass("chevron-down");$(this).removeClass("btn-minimize").addClass("btn-maximize")}else{$("i",$(this)).removeClass("chevron-down").addClass("chevron-up");$(this).removeClass("btn-maximize").addClass("btn-minimize")}a.slideToggle();bindToolTip();parent.autoHeight()});$("input:file").not('[data-no-uniform="true"],#uniform-is-ajax').uniform()}function bindToolTip(){$(".btn-submit").attr("data-original-title",top.T.BTN.Submit);$(".btn-browser1").attr("data-original-title",top.T.BTN.Browser);$(".btn-upload").attr("data-original-title",top.T.BTN.Upload);$(".btn-browser2").attr("data-original-title",top.T.BTN.Browser);$(".btn-download").attr("data-original-title",top.T.BTN.Download);$(".btn-lastdir").attr("data-original-title",top.T.BTN.Back);$(".btn-selectdir").attr("data-original-title",top.T.BTN.Confirm);$(".btn-cancel").attr("data-original-title",top.T.BTN.Cancel);$(".btn-minimize").attr("data-original-title",top.T.BTN.Minimize);$(".btn-maximize").attr("data-original-title",top.T.BTN.Maximize);$('[rel="tooltip"],[data-rel="tooltip"]').tooltip({"placement":"bottom",delay:{show:400,hide:200}})}function cancel(){$("#position_first").hide();$(".box-content",$("#position_first")).empty();$("#position_last").hide();$(".box-content",$("#position_last")).empty()}function browser(){initDocumentList("/");var a=$(".box-content",$("#position_share")).html();$(".box-content",$("#position_last")).empty();$(".box-content",$("#position_last")).html(a);$("#position_last").show();$(".box-content",$("#position_first")).empty();$("#position_first").hide();soureBrowser=false}function makeSureApply(){$("#apdownfile_hide").text(upLoadPath);$(".box-content",$("#position_first")).empty();$("#position_first").hide()}function appendDirHtml(){initDocumentList("/");var a=$(".box-content",$("#position_share")).html();$(".box-content",$("#position_first")).empty();$(".box-content",$("#position_first")).append(a);$("#position_first").show();$(".box-content",$("#position_last")).empty();$("#position_last").hide();soureBrowser=true}function initDocumentList(a){var b="/req/fileListReq.asp";if(a==null){a="/"}else{a=a.replace("\n","");a=a.replace(" ","")}$.post(b,{info:a},function(c){var o=c.lastIndexOf("<h2><b>");if(o!=-1){c=c.substring(0,o-1)}$("#documentList").empty();$("#folderList").empty();var l=c.split("\n");l.pop();var d=[];var m=[];d.push("/.. ");for(var f=0;f<l.length;f++){l[f]=l[f].replace(/\?/g,"");l[f]=l[f].replace(/(^\s*)|(\s*$)/g,"");if(l[f].indexOf("/")!=-1){d.push(l[f].replace(/\//g,""))}else{m.push(l[f].replace(/\*|@|\||=/,""))}}if(d.length>0){var p=d[d.length-1];if(p.length>=1){var h=d[d.length-1].indexOf("\n");if(h!=-1&&(h>(p.length/2))){d[d.length-1]=d[d.length-1].substring(0,h)}var e="<tr>";var k=1;for(var k=1;k<d.length+1;k++){if((k%3)==0&&k==d.length){e=e+"<td onclick='document_click(this)' style='cursor:pointer'><a href='#'><i name='d' class='halflings-icon folder-open'></i>"+d[k-1]+"</a></td></tr>"}else{if((k%3)==0){e=e+"<td onclick='document_click(this)' style='cursor:pointer'><a href='#'><i name='d' class='halflings-icon folder-open'></i>"+d[k-1]+"</a></td></tr><tr>"}else{e=e+"<td onclick='document_click(this)' style='cursor:pointer'><a href='#'><i name='d' class='halflings-icon folder-open'></i>"+d[k-1]+"</a></td>"}}}if(((k-1)%3)!=0){while(((k-1)%3)!=0){e=e+"<td>&nbsp;</td>";k++}}e=e+"</tr>";$("#folderList").append(e)}}if(m.length>0){var p=m[m.length-1];if(p.length>=1){var g=m[m.length-1].indexOf("\n");if(g!=-1&&(g>(p.length/2))){m[m.length-1]=m[m.length-1].substring(0,g)}var n="<tr>";k=1;for(var k=1;k<m.length+1;k++){if((k%3)==0&&k==m.length){n=n+"<td onclick='document_click(this)' style='cursor:pointer'><a href='#'><i name='f' class=' icon-file'></i>"+m[k-1]+"</a></td></tr>"}else{if((k%3)==0){n=n+"<td onclick='document_click(this)' style='cursor:pointer'><a href='#'><i name='f' class=' icon-file'></i>"+m[k-1]+"</a></td></tr><tr>"}else{n=n+"<td onclick='document_click(this)' style='cursor:pointer'><a href='#'><i name='f' class=' icon-file'></i>"+m[k-1]+"</a></td>"}}}if(((k-1)%3)!=0){while(((k-1)%3)!=0){n=n+"<td>&nbsp;</td>";k++}}n=n+"</tr>";$("#folderList").append(n)}}getCurPath()})}function document_click(b){var c=$(b).children().children().attr("name");var a=$(b).children();if(c=="f"){changeFile(a)}if(c=="d"){changeDir(a)}}function goback(){initDocumentList("/..")}function changeFile(b){if(!soureBrowser){var a=$(b).text();a=a.replace(/\s/g,"");a=a.replace(/\//g,"");$("#apdownfile").val(a);var c="/req/pathReq.asp";$.post(c,null,function(d){var e=d.indexOf("<h2><b>");if(e!=-1){d=d.substring(0,e)}if(d=="/"){$("#apdownfile_hide_2").text(d+a)}else{$("#apdownfile_hide_2").text(d+"/"+a)}});cancel()}}function changeDir(b){var a=$(b).text();initDocumentList(a);$("#apdownfile").val("")}var filename="";function submit_upload(){if($("#apdownfile_hide").text()==""){top.ModalCommon.open(top.T.Main.Notice,top.T.AlertInfo.SelectDir,"error");return false}var a=document.UpLoadConfigForm_auto.edtUpLoadFilePath_auto;if(a.value==""){top.ModalCommon.open(top.T.Main.Notice,top.T.AlertInfo.SelectFile,"error");return false}var b="/req/transferReq.asp";var c=$("#apdownfile_hide").text();$.post(b,{caseType:0,data:c},function(d){document.UpLoadConfigForm_auto.submit();parent.Progress.updateFeller(2)})}function submit_download_apply(){var a=$("#apdownfile").val();if(a==""){top.ModalCommon.open(top.T.Main.Notice,top.T.AlertInfo.SelectFile,"error")}else{tarClean(1);document.DownLoadForm.submit()}}function tarClean(b){$.ajaxSetup({async:false});var c="/req/rootCheckReq.asp";var a=1;if(b==null){$.post(c,null,function(d){if(d==1){a=0}})}if(a==1){c="/req/clearCacheReq.asp";$.post(c,null,function(d){if(b==null){top.ModalCommon.open(top.T.Main.Notice,top.T.AlertInfo.OperationSuccess,"ok")}})}$.ajaxSetup({async:true})}function getCurPath(){var a="/req/pathReq.asp";upLoadPath="";$.post(a,null,function(b){$("#curpath").val(b);$("#path").val(b);upLoadPath=b+"/"})}function validatePwd(){var b=$("#password").val();if(b==""){top.ModalCommon.open(top.T.Main.Notice,top.T.FileManagementPage.PasswordError,"error");return}b=md5(b);var a='ValidatePwd : password = "'+b+'"';parent.LMT.cmdSyn(a,function(d){var c=parent.LMT.parser(d);if(c.result==="000"){$("#password_field").hide();showFileOptField();top.ValidatePwd=true}else{top.ModalCommon.open(top.T.Main.Notice,top.T.FileManagementPage.PasswordError,"error")}})};